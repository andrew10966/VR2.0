<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>VR 2.0</title>
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body, html {
      height: 100%;
      color: #fff;
      background-color: rgb(31, 4, 56);
      font-family: Arial, sans-serif;
    }
    .sep{
        background-color: rgb(65, 7, 119);
        padding: 10px;
    }
    nav {
      position: fixed;
      width: 100%;
      top: 0;
      background-color: rgba(0, 0, 0, 0.2);
      padding: 10px 20px;
      z-index: 1000;
    }
    nav ul {
      list-style: none;
      display: flex;
      justify-content: space-around;
    }
    nav ul li {
      margin: 0 15px;
    }
    nav ul li a {
      color: #fff;
      text-decoration: none;
      font-weight: bold;
    }
    .hero {
      height: 100vh;
      background: url('https://f4.bcbits.com/img/a4291257388_10.jpg') no-repeat center center/cover;
      display: flex;
      justify-content: center;
      align-items: center;
      text-align: center;
      position: relative;
      color: white;
    }
    .hero h1 {
      font-size: 4em;
      margin-bottom: 20px;
    }
    .hero p {
      font-size: 1.5em;
    }
    .hero button {
      padding: 15px 30px;
      margin-top: 20px;
      font-size: 1.2em;
      color: #fff;
      background-color: #be33ff;
      border: none;
      cursor: not-allowed;
      border-radius: 5%;
      transition: background-color 0.3s ease;
    }
    .hero button:hover {
      background-color: #c42dbd;
    }
    .section {
      padding: 50px;
      text-align: center;
    }
    html {
      scroll-behavior: smooth;
    }
    footer{
        background-color: black;
        padding: 10px;
        text-align: center;
    }
    .collab-list {
    display: flex;
    flex-wrap: wrap;
    gap: 20px;
    justify-content: space-between;
}

.collab-item {
    background-color: #2c2c2c;
    border-radius: 10px;
    padding: 15px;
    width: 25%;
    max-width: 250px;
    position: relative;
    display: block;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    transition: transform 0.3s ease, background-color 0.3s ease;
}

.collab-item:hover {
    transform: scale(1.05);
    background-color: #3a3a3a;
}

.collab-item img {
    width: 100%;
    height: auto;
    border-radius: 5px;
    cursor: pointer;
    position: relative;
}

.play-pause-container {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -75%);
    display: flex;
    justify-content: center;
    align-items: center;
    width: 100px;
    height: 100px;
    cursor: pointer;
}

.play-pause-container svg {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
}

.play-pause-container circle {
    fill: none;
    stroke-width: 6;
    stroke: #3b82f6;
    stroke-dasharray: 283;
    stroke-dashoffset: 283;
    transition: stroke-dashoffset 0.1s linear;
    opacity: 0;
}

.play-pause-container i {
    position: absolute;
    font-size: 2em;
    color: white;
}

.playing .play-pause-container circle {
    opacity: 1;
}
a {
    text-decoration: none;
    color: white;
}
.divlist{
    margin: 20px 25% 0 25% ;
}
    
  </style>
</head>
<body>
  <nav>
    <ul>
      <li><a href="#home">Home</a></li>
      <li><a href="#download">Download</a></li>
      <li><a href="#community">Community</a></li>
      <li><a href="#team">Team</a></li>
    </ul>
  </nav>

  <section class="hero" id="home">
    <div class="hero-content">
      <h1>Virtual Riot Pack Vol. 2</h1>
      <p>Availabe 2025</p>
    </div>
  </section>
  <div class="sep"></div>

  <section class="section" id="listen">
    <h2>Listen to the Pack</h2>
    <div class="divlist"><div id="collab-list" class="collab-list"></div></div>
  </section>

  <section class="section" id="download">
    <h2>Download the Pack</h2>
    <p>Available Soon...</p>
  </section>

  <section class="section" id="community">
    <h2>Join the Community</h2>
    <p>Connect with other mappers and make contributions.</p>
  </section>

  <section class="section" id="team">
    <h2>Meet the Team</h2>
    <h4>Pack Lead</h4>
    <p>⚬ Avexus</p>
    <h4>Mappers</h4>
    <p>⚬ Avexus</p>
    <p>⚬ AndrewFCC</p>
    <p>⚬ Bytrius</p>
    <p>⚬ Spinvvy</p>
    <p>⚬ EerieWolf</p>
    <p>⚬ Rxerti</p>
    <p>⚬ Nitronik</p>
    <h4>Lighters</h4>
    <p>⚬ AndrewFCC</p>
    <p>⚬ Rxerti</p>
  </section>
  <div class="sep"></div>

  <footer>
    <p>!! This neither official or supported by Virtual Riot or Beat Games !!</p>
    <p>Made by community member AndrewFCC</p>
  </footer>

  <script>
    /*
CC BY-SA 4.0 https://creativecommons.org/licenses/by-sa/4.0/
*/

const clientId = "c1fa42a799fb45bbbeb59c08944142c2";
const clientSecret = "92a4e5f2636f4adf805076b35cfb9a57";
const tokenUrl = "https://accounts.spotify.com/api/token";
const apiUrl = "https://api.spotify.com/v1/tracks/";

let currentAudio = null;
let currentlyPlayingItem = null;

// Fetch a token for Spotify API
async function fetchToken() {
    const response = await fetch(tokenUrl, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/x-www-form-urlencoded',
            'Authorization': `Basic ${btoa(`${clientId}:${clientSecret}`)}`
        },
        body: new URLSearchParams({ grant_type: 'client_credentials' })
    });
    const data = await response.json();
    return data.access_token;
}

// Fetch specific track data from Spotify using the track's ID
async function fetchTrackData(trackId) {
    const token = await fetchToken();
    const response = await fetch(apiUrl + trackId, {
        headers: { 'Authorization': `Bearer ${token}` }
    });
    return await response.json();
}

// Create a collab item (song) to display
function createCollabItem(track, statuses, genres) {
    // Check if track has a valid preview URL, album image, and artist data
    if (!track || !track.preview_url || !track.album || !track.album.images || !track.album.images[0] || !track.artists) {
        console.warn(`Skipping track with no preview: ${track ? track.id : 'unknown track'}`);
        return null; // Return null to skip track without preview
    }

    const item = document.createElement('div');
    item.className = 'collab-item';

    // Set up the HTML structure for the item (album cover, track name, artist, etc.)
    item.innerHTML = `
        <img src="${track.album.images[0].url}" class="cover-img" data-preview="${track.preview_url}" alt="${track.name}">
        <div class="play-pause-container">
            <svg viewBox="0 0 100 100">
                <circle cx="50" cy="50" r="45"></circle>
            </svg>
            <i class="fa fa-play"></i>
        </div>
        <h3><a href="https://open.spotify.com/track/${track.id}" target="_blank">${track.name}</a></h3>
        <p>Artist(s): ${track.artists.map(artist => artist.name).join(', ')}</p>
        <p>Length: ${Math.floor(track.duration_ms / 60000)}:${(Math.floor((track.duration_ms % 60000) / 1000)).toString().padStart(2, '0')}</p>
    `;

    // Enable preview audio playback when clicking the cover image
    item.querySelector('.cover-img').addEventListener('click', function () {
        togglePreview(track.preview_url, item);
    });

    // Also enable preview audio playback when clicking the play/pause button
    item.querySelector('.play-pause-container').addEventListener('click', function () {
        togglePreview(track.preview_url, item);
    });

    return item;
}

// Handle the preview audio playback and update progress bar
function togglePreview(url, item) {
    const playPauseIcon = item.querySelector('.play-pause-container i');
    const progressCircle = item.querySelector('.play-pause-container circle');
    
    if (currentAudio) {
        if (currentAudio.src === url) {
            if (currentAudio.paused) {
                currentAudio.play();
                playPauseIcon.className = 'fa fa-pause';
                item.classList.add('playing'); // Show progress bar
            } else {
                currentAudio.pause();
                playPauseIcon.className = 'fa fa-play';
                item.classList.remove('playing'); // Hide progress bar
            }
        } else {
            if (currentlyPlayingItem) {
                currentlyPlayingItem.querySelector('.play-pause-container i').className = 'fa fa-play';
                currentlyPlayingItem.classList.remove('playing');
                clearInterval(currentlyPlayingItem.progressInterval); // Clear any existing progress intervals
            }

            currentAudio.pause();
            currentAudio = new Audio(url);
            currentAudio.play();
            playPauseIcon.className = 'fa fa-pause';
            item.classList.add('playing');
            currentlyPlayingItem = item;

            // Update progress bar
            currentlyPlayingItem.progressInterval = setInterval(() => {
                const progress = (currentAudio.currentTime / currentAudio.duration) * 283;
                progressCircle.style.strokeDashoffset = 283 - progress;
            }, 100);

            currentAudio.addEventListener('ended', () => {
                playPauseIcon.className = 'fa fa-play';
                clearInterval(currentlyPlayingItem.progressInterval);
                progressCircle.style.strokeDashoffset = 283; // Reset progress
                item.classList.remove('playing'); // Hide progress bar
            });
        }
    } else {
        currentAudio = new Audio(url);
        currentAudio.play();
        playPauseIcon.className = 'fa fa-pause';
        item.classList.add('playing');
        currentlyPlayingItem = item;

        // Update progress bar
        currentlyPlayingItem.progressInterval = setInterval(() => {
            const progress = (currentAudio.currentTime / currentAudio.duration) * 283;
            progressCircle.style.strokeDashoffset = 283 - progress;
        }, 100);

        currentAudio.addEventListener('ended', () => {
            playPauseIcon.className = 'fa fa-play';
            clearInterval(currentlyPlayingItem.progressInterval);
            progressCircle.style.strokeDashoffset = 283; // Reset progress
            item.classList.remove('playing'); // Hide progress bar
        });
    }
}

const trackIds = [
    { id: '1m0Y47ublXhXBMPPuq803r'},
    { id: '6aTN1V5VCHjn8q73XsXTCT'},
    { id: '0TPF2GBCH08gLC40qvDjvD'},
];


// Shuffle array function
function shuffleArray(array) {
    for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
    }
}
shuffleArray(trackIds);

// Fetch and display the tracks
trackIds.forEach(async (track) => {
    const trackData = await fetchTrackData(track.id);
    
    // Only create and append collab item if the track data is valid
    if (trackData) {
        const collabItem = createCollabItem(trackData, track.status, track.genres);
        if (collabItem) {
            document.getElementById('collab-list').appendChild(collabItem);
        }
    }
});
  </script>
</body>
</html>
